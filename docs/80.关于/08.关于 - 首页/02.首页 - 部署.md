---
title: é¦–é¡µ - éƒ¨ç½²
date: 2021-12-09 21:57:35
permalink: /about/index/younngkbt/
titleTag: åŸåˆ›
categories:
  - å…³äº - é¦–é¡µ
tags: 
  - é¦–é¡µ
---

::: note

è¿™é‡Œç®€å•ä»‹ç»æˆ‘çš„é¦–é¡µåˆ›å»ºè¿‡ç¨‹ï¼Œä»¥åŠé‚®ä»¶åŠŸèƒ½çš„è®¾è®¡è¿‡ç¨‹ã€‚

::: right

2021-12-09 @Young Kbt

:::

[[TOC]]

## åºè¨€

åœ¨å­¦ä¹ å®Œ Nginx çš„çŸ¥è¯†åï¼Œæˆ‘çœ‹ç€ Nginx çš„æ¬¢è¿é¡µé¢ç»†æƒ³äº†å¾ˆä¹…ï¼Œçœ¼ä¸­çš„ä¸–ç•Œå¤ªè¿‡å•è°ƒï¼Œæ€»è§‰å¾—ä¸å¤Ÿå¥½çœ‹ï¼Œè€Œä¸”æ— æ³•ç»™æˆ‘çš„æœåŠ¡å™¨æä¾›ä»»ä½•ä¿¡æ¯ä»‹ç»ï¼Œè€Œå‘¨å›´çš„æœ‹å‹ç›´æ¥æ˜¯å°†å…¶ä»£ç†åˆ°å…¶ä»–é¡µé¢ã€‚

å½“æ—¶æˆ‘å°±æœ‰äº†ä¸€äº›æƒ³æ³•ï¼Œæ›¿æ¢ Nginx çš„æ¬¢è¿é¡µé¢ï¼Œå°†æ–°çš„é¡µé¢ä½œä¸ºå…¥å£é¡µé¢ï¼Œä»‹ç»ç½‘ç«™åŠŸèƒ½çš„åŒæ—¶ï¼Œæä¾›åšå®¢ã€é¡¹ç›®å¯¼èˆªå…¥å£ã€‚æ¯”å¦‚æˆ‘éƒ¨ç½²çš„ä¸€ä¸ªé¡¹ç›®ï¼Œé‚£ä¹ˆåœ¨é¦–é¡µå°±ä¼šæœ‰æç¤ºï¼Œå¦‚ç‚¹å‡»è·³è½¬ï¼Œè¿™æ ·å°±ä¸å¿…è®°ä½é¡¹ç›®çš„ URL åœ°å€ï¼Œåªéœ€è¦è®°ä½æœåŠ¡å™¨åœ°å€ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å…¶ä»–çš„å†…å®¹ï¼Œéƒ½æ±‡èšäºé¦–é¡µã€‚

å¦‚æœä½ æ˜¯ä» Github æˆ–è€… Gitee è¿›å…¥åˆ°æˆ‘çš„åšå®¢ï¼Œé‚£ä¹ˆå¯ä»¥å»çœ‹çœ‹æˆ‘çš„æœåŠ¡å™¨é¦–é¡µï¼Œå¸Œæœ›ä¸ä¼šè®©ä½ å¤±æœ›ï¼Œ[ç‚¹å‡»è·³è½¬](https://www.youngkbt.cn)ã€‚

å¦‚æœä½ çœ‹å®Œäº†ä¸‹é¢çš„å†…å®¹ï¼Œéœ€è¦æˆ‘çš„æœåŠ¡å™¨é¦–é¡µã€404é¡µé¢ã€é‚®ç®±åŠŸèƒ½ã€ä¸‹è½½ç«™ç‚¹åŠŸèƒ½çš„æºç ï¼Œé‚£ä¹ˆ [ç‚¹å‡»è·³è½¬](https://www.youngkbt.cn/download/light/%E7%BD%91%E7%AB%99%E6%BA%90%E7%A0%81/)ã€‚

## é¦–é¡µéƒ¨ç½²

é¦–å…ˆå‡†å¤‡å¥½ä¸€ä¸ªé¦–é¡µï¼Œä¸éœ€è¦æ‰“åŒ…ä¹‹ç±»çš„ï¼ŒNginx çš„é¦–é¡µåªæ˜¯ä¸€ä¸ª index.html åŠ ç‚¹ CSS å’Œ JS æ–‡ä»¶å³å¯ï¼Œä¸éœ€è¦åƒä¸€ä¸ªé¡¹ç›®é‚£æ ·å®Œæ•´ã€‚

åˆ©ç”¨å·¥å…·è¿æ¥æœåŠ¡å™¨ï¼Œæˆ‘æ˜¯ç”¨çš„æ˜¯ `Xftp`ï¼Œå°†å…¶ä¸Šä¼ åˆ° Nginx çš„é»˜è®¤è·¯å¾„ä¸‹ã€‚

Nginx çš„é»˜è®¤è·¯å¾„ä¸‹å¦‚æœä½ ä¸çŸ¥é“ï¼Œæ‰“å¼€ Nginx çš„é…ç½®æ–‡ä»¶ï¼Œçœ‹ 80 æˆ–è€… 431ç«¯å£çš„ `location / { ... }` é‡Œçš„ root æŒ‡å®šçš„è·¯å¾„ï¼Œé‚£å°±æ˜¯ Nginx çš„é»˜è®¤è·¯å¾„ã€‚

![image-20211209221550925](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211209221553.png)



è¿™å°±æ˜¯æˆ‘çš„é»˜è®¤è·¯å¾„ï¼Œæ‰€ä»¥å°†é¦–é¡µä»¥åŠé™æ€æ–‡ä»¶ä¸Šä¼ åˆ° Nginx é»˜è®¤è·¯å¾„ä¸‹ã€‚

åœ¨æœ¬åœ°ï¼Œæˆ‘çš„é¦–é¡µç»“æ„å¦‚ä¸‹ï¼š

```md
.
â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ assets (é™æ€æ–‡ä»¶ç›®å½•)
â”‚   â”‚   â”œâ”€â”€ cssï¼ˆæ ·å¼ç›®å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ fontsï¼ˆå­—ä½“ç›®å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ imagesï¼ˆå›¾ç‰‡ç›®å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ jsï¼ˆJavaScript ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ vendorï¼ˆJavaScript åº“ï¼‰
â”‚   â”‚   â”œâ”€â”€ bootstrap
|	â”‚	â”œâ”€â”€ jquery
```

ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼Œå› ä¸ºé»˜è®¤è·¯å¾„ä¸‹å¯èƒ½æœ‰å¤ªå¤šæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘å¯¹å…¶åˆ†ç±»ï¼Œåˆ›å»ºä¸€ä¸ª static æ–‡ä»¶å¤¹ã€‚

```
æ ¹ç›®å½•
â”œâ”€â”€ index.html
|â€”â€” staticï¼ˆé™æ€æ–‡ä»¶ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â”œâ”€â”€ cssï¼ˆæ ·å¼ç›®å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ fontsï¼ˆå­—ä½“ç›®å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ imagesï¼ˆå›¾ç‰‡ç›®å½•ï¼‰
â”‚   â”‚   â”œâ”€â”€ jsï¼ˆJavaScript ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ vendorï¼ˆJavaScript åº“ï¼‰
â”‚   â”‚   â”œâ”€â”€ bootstrap
|	â”‚	â”œâ”€â”€ jquery
```

æ ¹ç›®å½•ï¼Œå°±æ˜¯ `/usr/local/openresty/nginx/html` ç›®å½•ã€‚

ä¸Šä¼ é¦–é¡µåï¼Œè®°å¾—ä¿®æ”¹ index.html æœ‰å…³ css å’Œ js çš„å¼•å…¥è·¯å¾„ï¼Œå› ä¸º Nginx çš„è·å–èµ„æºè§„åˆ™å’Œæœ¬åœ°çš„ä¸ä¸€æ ·ã€‚

åœ¨æœ¬åœ°ï¼Œæˆ‘ä»¬åœ¨ index.html å¯ä»¥è¿™æ ·å†™ï¼šï¼ˆéƒ¨åˆ†ï¼‰

```html
<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link href="assets/fonts/iconfont.css" rel="stylesheet" />
<script src="vendor/jquery/jquery.min.js"></script>
```

ä½†æ˜¯ä¸Šä¼ åˆ° Nginx åï¼Œæˆ‘ä»¬å¿…é¡»åœ¨å¼€å¤´åŠ ä¸Š `/`ï¼Œä»£è¡¨ Nginx çš„æ ¹ç›®å½•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿™æ ·å†™ï¼šï¼ˆéƒ¨åˆ†ï¼‰

```html
<link href="/static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<link href="/static/assets/fonts/iconfont.css"  rel="stylesheet"  />
<script src="/static/vendor/jquery/jquery.min.js"></script>
```

ç„¶åï¼Œè®¿é—®æœåŠ¡å™¨çš„åŸŸåï¼Œå³å¯è®¿é—®è¿™ä¸ªé¦–é¡µã€‚å½“ç„¶ï¼Œå¦‚æœå¸Œæœ›è®¿é—®åŸŸåçš„åé¢å†åŠ ä¸ª `/home`ï¼Œå¦‚è®¿é—® `https://www.youngkbt.cn/home` ï¼Œä¹Ÿèƒ½è®¿é—®é¦–é¡µçš„è¯ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚

```nginx {6-9}
server {
    listen 80;		# 431 æ˜¯ https çš„é»˜è®¤ç«¯å£ï¼Œ80 æ˜¯ http çš„é»˜è®¤ç«¯å£
    server_name www.youngkbt.cn;
    # ...... å…¶ä»– location
    
    location /home {
        alias  /usr/local/openresty/nginx/html;
        index  index.html;
    }
    
    # ...... å…¶ä»– location
}
```

è¿™é‡Œä½¿ç”¨çš„æ˜¯ alias æŒ‡ä»¤ï¼Œå› ä¸º root æŒ‡ä»¤ä¼šæŠŠ location åé¢åŒ¹é…çš„è¯·æ±‚æ‹¼æ¥åˆ°ç›®å½•åï¼Œè€Œ alias æŒ‡ä»¤åˆ™ä¼šå¿½ç•¥ location ååŒ¹é…çš„è¯·æ±‚ã€‚

alias æŒ‡ä»¤ä¸ä¼šå¿½ç•¥åŒ¹é…åé¢çš„è¯·æ±‚ï¼Œå¦‚è®¿é—® `/home/aa`ï¼Œåˆ™å¿½ç•¥ `/home`ï¼Œä½†æ˜¯æŠŠ `/aa` æ‹¼æ¥åˆ°ç›®å½•åï¼Œä½†æ˜¯è¿™ä¸å½±å“æˆ‘ä»¬è®¿é—® `/home` å°±èƒ½è®¿é—®åˆ°é¦–é¡µï¼Œè¿™é‡Œåªæ˜¯ä»‹ç»ä½¿ç”¨ alias æŒ‡ä»¤çš„ç‰¹ç‚¹ã€‚

**JS æ–‡ä»¶**

åœ¨é¦–é¡µï¼Œæˆ‘ç®€å•å®ç°äº† Element UI çš„æ¶ˆæ¯æç¤ºæ•ˆæœï¼Œä¹Ÿå®ç°äº†é‚®ç®±å‘é€åŠŸèƒ½ï¼Œè¿™é‡Œæä¾›æºç ï¼š

```js
$(function () {
  var storageName = "isSend";
  
  // é˜²æ­¢é‡å¤å‘é€
  var isSend = false;
  $(".button").on("click", function () {
    if ($("#name").val() == '') {
      addTip("å§“åä¸èƒ½ä¸ºç©ºï¼Œè¯·å¡«å†™", "danger");
      return;
    } else if ($("#email").val() == '') {
      addTip("é‚®ç®±ä¸èƒ½ä¸ºç©ºï¼Œè¯·å¡«å†™", "danger");
      return;
    } else if ($("#subject").val() == '') {
      addTip("æ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼Œè¯·å¡«å†™", "danger");
      return;
    } else if ($("#message").val() == '') {
      addTip("æ¶ˆæ¯ä¸èƒ½ä¸ºç©ºï¼Œè¯·å¡«å†™", "danger");
      return;
    } else {
      var email = $("#email").val();
      var reg = /^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;
      if (reg.test(email) && (sessionStorage.getItem(storageName) != "true" || isSend == false)) {
        if (confirm("ç¡®è®¤è¦å‘é€å—ï¼Ÿ")) {
          sendEmail();
          sessionStorage.setItem(storageName,true);
          isSend = true;
        }
      } else if (sessionStorage.getItem(storageName) == "true" || isSend == true) {
        addTip("è¯·ä¸è¦é‡å¤å‘é€æ¶ˆæ¯", "warning");
      } else {
        addTip("é‚®ç®±æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·å¡«å†™", "danger");
      }
    }

    // è·å–è¡¨å•ä¿¡æ¯
    // console.log($("#contact").serialize());  
  })
  function sendEmail() {
    $.post("/sendEmail", $("#contact").serialize(), function (res, error) {
      if (res == 'OK') {  
        addTip("å‘é€æ¶ˆæ¯æˆåŠŸ", "success");
        setTimeout(() => {
          window.location.reload();
          sessionStorage.removeItem(storageName);
          isSend == false;
        }, 1500);
      } else {
        console.log("å¤±è´¥çš„åŸå› ï¼š", error);
        addTip("å‘é€å¤±è´¥ï¼Œå¯èƒ½å‘é€è¶…æ—¶æˆ–æ¶ˆæ¯è¢«æ‹¦æˆªï¼Œè¯·ç¨åå†é‡è¯•", "tip");
      }
    });
  }

  // æ·»åŠ æ¶ˆæ¯æç¤º
  function addTip(content, type) {

    var time = new Date().getTime();
    // è·å–æœ€åæ¶ˆæ¯æç¤ºå…ƒç´ çš„é«˜åº¦
    var top = $(".tip:last").attr("data-top") == undefined ? 0 : $(".tip:last").attr("data-top");
    // å¦‚æœäº§ç”Ÿä¸¤ä¸ªä»¥ä¸Šçš„æ¶ˆæ¯æç¤ºï¼Œåˆ™å‡ºç°åœ¨ä¸Šä¸€ä¸ªæç¤ºçš„ä¸‹é¢ï¼Œå³é«˜åº¦æ·»åŠ ï¼Œå¦åˆ™é»˜è®¤ 20
    var lastTop = parseInt(top) + ($(".tip").length > 0 ? $(".tip:last").outerHeight() + 17 : 20);

    if (type == "success" || type == 1) {
      $("#page-wraper").append(`<div class="tip tip-success ${time}" style="top: ${parseInt(top)}px" data-top="${lastTop}"><i class="iconfont icon-dagouyouquan icon"></i><p class="tip-success-content">${content}</p></div>`);
    } else if (type == "danger" || type == 2) {
      $("#page-wraper").append(`<div class="tip tip-danger ${time}" style="top: ${parseInt(top)}px" data-top="${lastTop}><i class="iconfont icon-cuowu icon"></i><p class="tip-danger-content">${content}</p></div>`);
    } else if (type == "info" || type == 3) {
      $("#page-wraper").append(`<div class="tip tip-info ${time}" style="top: ${parseInt(top)}px" data-top="${lastTop}><i class="iconfont icon-info icon"></i><p class="tip-info-content">${content}</p></div>`);
    } else if (type == "warning" || type == 4) {
      $("#page-wraper").append(`<div class="tip tip-warning ${time}" style="top: ${parseInt(top)}px" data-top="${lastTop}><i class="iconfont icon-gantanhao icon"></i><p class="tip-warning-content">${content}</p></div>`);
    }

    // åŠ¨ç”»å¾€ä¸‹æ»‘åŠ¨
    $("." + time).animate({
      top: parseInt(lastTop) + "px",
      opacity: "1",
    })

    // æ¶ˆæ¯æç¤º 3 ç§’åéšè—å¹¶è¢«åˆ é™¤
    setTimeout(() => {
      $("." + time).animate({
        top: "0px",
        opacity: "0",
      });

      setTimeout(() => {
        $("." + time).remove();
      }, 500);
    }, 3000);
  }
})
```

æ¶ˆæ¯æç¤ºæ•ˆæœçš„ CSS æ–‡ä»¶å†…å®¹ï¼š

```css
/* æ¶ˆæ¯æç¤ºæ ·å¼ */
.tip{
  position: fixed;
  display: flex;
  height: 48px;
  top: -10px;
  left: 50%;
  opacity: 0;
  min-width: 320px;
  transform: translateX(-50%);
  transition: opacity .3s linear,top .4s,transform .4s;
  z-index: 99999;
  padding: 15px 15px 15px 20px;
  border: 1px solid #ebeef5;
  border-radius: 4px;
  grid-row: 1;
  line-height: 17px;
}
.tip p{
  line-height: 17px;
  margin: 0;
  font-size: 14px;
}
.icon{
  margin-right: 10px;
  line-height: 17px;
}
.tip-success  {
  color: #67c23a;
  background-color: #f0f9eb;
  border-color: #e1f3d8;
}
.tip-success .tip-success-content{
  color: #67c23a;
}
.tip-danger {
  color: #f56c6c;
  background-color: #fef0f0;
  border-color: #fde2e2;
}
.tip-danger .tip-danger-content{
  color: #f56c6c;
}
.tip-info {
  background-color: #edf2fc;
  border-color: #ebeef5;
}
.tip-info .tip-info-content{
  color: #909399;
}

.tip-warning {
  color: #e6a23c;
  background-color: #fdf6ec;
  border-color: #faecd8;
}
.tip-warning .tip-warning-content{
  margin: 0;
  color: #e6a23c;
  line-height: 21px;
  font-size: 14px;
}
/* ä¸‹é¢æ˜¯äºŒç»´ç æ ·å¼ */
.social-tip{
  margin-bottom: 170px;
  display: none;
} 
.square{
    width: 0;
    height: 0;
    border-bottom: 7px solid rgba(118, 25, 172, 0.3);
    border-right: 7px solid transparent;
    border-left: 7px solid transparent;
    position: relative;
    left: 36%;
}
.social-info{
  width: 200px;
  position: absolute;
  line-height: 48px;
  left: -95%;
  margin-left: -40px;
  background-color: rgba(118, 25, 172, 0.3);
  color: #fff;
  padding: 0 15px 15px;
}
.social-info img{
  width: 160px;
  height: 160px;
}

```

å¦‚ä¸‹æ•ˆæœï¼š

![image-20211210002312627](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211210002314.png)

æˆ‘è®¾è®¡äº†å››ä¸ªæç¤ºï¼Œåˆ†åˆ«æ˜¯æˆåŠŸç»¿è‰²ï¼Œæç¤ºç°è‰²ï¼Œè­¦å‘Šé»„è‰²ï¼Œé”™è¯¯çº¢è‰²ã€‚è€Œæç¤ºè¯­å‰é¢çš„å›¾æ ‡ï¼Œéœ€è¦è‡ªå·±å»é˜¿é‡Œäº‘çš„çŸ¢é‡åº“è¿›è¡Œè·å–ï¼Œå¹¶åœ¨é¦–é¡µå¼•ç”¨ï¼Œ[çŸ¢é‡åº“è·³è½¬](https://www.iconfont.cn/)ã€‚

## 404éƒ¨ç½²

ä½ å–œæ¬¢ Nginx è‡ªå¸¦çš„ 404 é¡µé¢å—ï¼Ÿæˆ‘å¯èƒ½ä¸æ˜¯ç‰¹åˆ«å–œæ¬¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å¥½çœ‹çš„ 404 é¡µé¢ï¼Œåˆæˆ–è€…å»ç½‘ä¸Šä¸‹è½½åˆ«äººåšå¥½çš„ 404 é¡µé¢æ¨¡æ¿ã€‚å¦‚æˆ‘çš„ 404 é¡µé¢å¦‚å›¾ï¼š

![image-20211210002746928](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211210002748.png)

ç‚¹å‡»å¤´åƒè¿˜èƒ½æ’­æ”¾éŸ³ä¹ã€‚

åˆ©ç”¨ `xftp` å°† 404 é¡µé¢ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œæˆ‘åœ¨ Nginx æ ¹ç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ª 404 æ–‡ä»¶å¤¹ï¼Œå°† 404 é¡µé¢å’Œå…¶ CSS å’Œ JS æ–‡ä»¶æ”¾åˆ°è¿™ä¸ª 404 æ–‡ä»¶å¤¹é‡Œã€‚

ç›®å½•ç»“æ„ï¼š

``` md
æ ¹ç›®å½•
|â€”â€” 404ï¼ˆè¿™æ˜¯ä¸ªç›®å½•ï¼‰
â”‚   â”œâ”€â”€ 404.htmlï¼ˆ 404 é¡µé¢ï¼‰
â”‚   â”œâ”€â”€ cssï¼ˆæ ·å¼ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ imgï¼ˆå›¾ç‰‡ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ jsï¼ˆJavaScript ç›®å½•ï¼‰
|	â”œâ”€â”€ musicï¼ˆéŸ³ä¹ç›®å½•ï¼‰
|
â”œâ”€â”€ index.htmlï¼ˆå…¶ä»–é¡µé¢ï¼‰
```

ä¸Šä¼ ååˆ° Nginx åï¼Œå…»æˆå¥½ä¹ æƒ¯ï¼Œæ‰“å¼€ 404.htmlï¼Œä¿®æ”¹ CSSã€JS æ–‡ä»¶çš„å¼•å…¥è·¯å¾„ï¼Œå› ä¸º Nginx çš„è·å–èµ„æºè§„åˆ™å’Œæœ¬åœ°çš„ä¸ä¸€æ ·ã€‚

è®°å¾—å¼€å¤´åŠ  `/`ï¼Œæ”¹ä¸ºï¼šï¼ˆéƒ¨åˆ†ï¼‰

```html
<link rel="stylesheet" href="/404/css/ghost.css">
<script type="text/javascript" src="/404/js/jquery.min.js"></script>
```

ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¿®æ”¹ 404 é¡µé¢çš„è®¿é—®è·¯å¾„

```nginx {6-10}
server {
    listen 431;		# 431 æ˜¯ https çš„é»˜è®¤ç«¯å£ï¼Œ80 æ˜¯ http çš„é»˜è®¤ç«¯å£
    server_name youngkbt.cn;
    # ...... å…¶ä»– location
    
    error_page   404 500 502 503 504 /404.html;
    location = /404.html {
        root    /usr/local/openresty/nginx/html/404;
        index 404.html;
    }
    
    # ...... å…¶ä»– location
}
```

æ­¤æ—¶ä½ éšä¾¿è®¿é—®æˆ‘çš„æœåŠ¡å™¨åœ°å€ï¼Œå¦‚ `https://www.youngkbt.cn/aaa` é‚£ä¹ˆå°±ä¼šæ˜¾ç¤ºæˆ‘çš„ 404 é¡µé¢ã€‚åœ¨è¯¥é¡µé¢ä¸­ï¼Œç‚¹å‡»æˆ‘çš„å¤´åƒåï¼ŒéŸ³ä¹ä¼šä¼´éšå¤´åƒçš„æ—‹è½¬è€Œç¼“ç¼“å“èµ·ï¼Œé™é™äº«å— 404 å¸¦æœ‰çš„é™è°§æ—¶åˆ»ã€‚

## åšå®¢éƒ¨ç½²

æˆ‘çš„åšå®¢å·²ç»éƒ¨ç½²åœ¨ Github å’Œ Gitee ä¸­ï¼Œå¦‚æœä½ çœ‹äº†ä¸Šä¸€ä¸ªæ–‡ç« ï¼Œéƒ¨ç½²è‡ªå·±çš„åšå®¢åˆ°äº†æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±è¯·åœ¨ Nginx è®¾ç½®ä¸€ä¸ª location æ¨¡å—ï¼Œè¿›è¡Œè·³è½¬å§ã€‚

æˆ‘è®¾ç½®äº†ä¸¤ä¸ª location æ¨¡å—ï¼Œå½“è¾“å…¥ `/notes` æˆ–è€… `/note-blog` çš„æ—¶å€™ï¼Œéƒ½ä¼šè·³è½¬åˆ°æˆ‘çš„åšå®¢é¦–é¡µ

```nginx
location /notes {
    rewrite ^/notes/(\w*)$ /notes-blog/$1;
}
location /notes-blog {
    root /home/kbt;
    index index.html;
}
```

å®é™…ä¸Šï¼Œæœ€ç»ˆéƒ½ä¼šè·³åˆ° `/note-blog` çš„ location æ¨¡å—é‡Œã€‚

æˆ‘ä»¬ä¸ä»…å¯ä»¥è®¾ç½®åšå®¢çš„ locationï¼Œä¹Ÿå¯ä»¥è®¾ç½®æµè§ˆå™¨çš„ç¼“å­˜é™æ€æ–‡ä»¶æ—¶é—´ï¼Œå› ä¸ºåšå®¢çš„é™æ€æ–‡ä»¶å¤ªå¤šï¼Œå½“ç”¨æˆ·æ¯æ¬¡è®¿é—®éƒ½ä» Nginx æœåŠ¡å™¨è·å–é™æ€æ–‡ä»¶ï¼Œé‚£æ˜¾ç„¶ä¸ç†æ™ºï¼Œæˆ‘ä»¬å¯ä»¥è®©ç”¨æˆ·è®¿é—®è¿‡çš„é™æ€æ–‡ä»¶ï¼Œç¼“å­˜åˆ°ç”¨æˆ·çš„æµè§ˆå™¨ä¸­ï¼Œè¿™æ ·ï¼Œç”¨æˆ·å†æ¬¡è®¿é—®åšå®¢çš„æ—¶å€™ï¼Œç›´æ¥ä»æµè§ˆå™¨æœ¬åœ°è·å–ï¼Œæ‰“å¼€çš„é€Ÿåº¦éå¸¸å¿«ã€‚

æˆ‘è®¾ç½®äº†é™æ€æ–‡ä»¶ç¼“å­˜ 7 å¤©ï¼Œhtml æ–‡ä»¶ç¼“å­˜ 1 å¤©

```nginx
location ~ /note-blog/.*\.(js|css|png|jpg|jpeg|gif)$ {
    root /home/kbt;
    expires 7d;  # ç¼“å­˜ä¸ƒå¤©
}

location ~ /note-blog/.*\.(html)$ {
    root /home/kbt;
    expires 1d;  # ç¼“å­˜ä¸€å¤©
}
```

çœ‹åˆ° root äº†å—ï¼Œæˆ‘çš„åšå®¢å¹¶æ²¡æœ‰æ”¾åœ¨ Nginx çš„é»˜è®¤è·¯å¾„ä¸‹ï¼Œè€Œæ˜¯ç”±æ™®é€šç”¨æˆ· kbt ç®¡ç†ã€‚é˜²æ­¢æ»¥ç”¨ root æƒé™ï¼Œé¿å…è¢«åˆ«äººæ¶æ„è®¿é—®ã€‚

## é‚®ç®±éƒ¨ç½²

å»ºè®®ä½ çœ‹åˆ°è¿™é‡Œé©¬ä¸Šåœä½ï¼Œç„¶åç‚¹å‡» [æµ‹è¯•å‘é€é‚®ç®±](https://www.youngkbt.cn/?contact=1)ï¼Œè¾“å…¥ä½ çš„é‚®ç®±ï¼Œè¿›è¡Œå‘é€ï¼Œä½“éªŒä¹‹åå†æ¥å­¦ä¹ ï¼Œä¼šæœ‰æ›´å¤§çš„æ”¶è·å’Œå…´è¶£ã€‚

é‚®ç®±é¡¹ç›®æˆ‘ä½¿ç”¨äº† node å’Œ express æ¥æ­å»ºç®€å•çš„æœåŠ¡å™¨ï¼Œç„¶ååˆ©ç”¨ nodemailer è¿›è¡Œé‚®ä»¶å‘é€ï¼Œlog4j.js è¿›è¡Œæ—¥å¿—ä¿¡æ¯å­˜å‚¨ã€‚

è¿™æ˜¯ä¸€ä¸ª node ç®€å•é¡¹ç›®ï¼Œå®‰è£…çš„ä¾èµ–åªæœ‰ä¸‰ä¸ªï¼Œexpressã€nodemailerã€log4jsã€‚

### é‚®ç®±æºç 

æˆ‘çš„ package.json æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š

```json
{
    "name": "email",
    "version": "1.0",
    "private": true,
    "scripts": {
        "dev": "node app.js"
    },
    "dependencies": {
        "express": "^4.17.1",
        "log4js": "^6.3.0",
        "nodemailer": "^6.7.2"
    }
}
```

ä¾èµ–åªæœ‰ä¸‰ä¸ªï¼Œå¦‚ä½•å®‰è£…å‘¢ï¼Œæˆ‘ä½¿ç”¨ yarn è¿›è¡Œå®‰è£…ã€‚

```sh
yarn add express --save
yarn add log4js --save
yarn add nodemailer --save
```

å®‰è£…å®Œï¼Œæˆ‘ä»¬å…ˆç¼–å†™ log.js æ–‡ä»¶ï¼Œå®ç°æ—¥å¿—åŠŸèƒ½

```js
// å¼•å…¥æ’ä»¶ log4js  
var log4js = require('log4js')
log4js.configure({
    appenders: {	// é…ç½®æ—¥å¿—æ–‡ä»¶
        access: {    // è®¿é—®æ—¥å¿—çš„ name
            type: 'file',     
            filename: "logs/access.log",
            layout: {
                type: 'pattern',
                pattern: '[%d{yyyy-MM-dd hh:mm:ss SSS}] [%p] %c - %m'
            },
        },
        error: {    // é”™è¯¯æ—¥å¿—çš„ name
            type: 'file',
            filename: "logs/error.log",
            layout: {   // å®šä¹‰æ—¥å¿—è¾“å‡ºçš„æ ·å¼
                type: 'pattern',
                pattern: '[%d{yyyy MM dd hh:mm:ss SSS}] [%p] %c - %m%n' // æ—¥å¿—è¾“å‡ºæ—¶é—´æ ¼å¼
            },
        },
    },

    categories: {	// é…ç½®æ—¥å¿—çº§åˆ«ï¼Œä»¥åŠå¼•ç”¨ appenders é…ç½®çš„æ—¥å¿—æ–‡ä»¶
        default: { appenders: ['access'], level: 'info' },  // ä¸Šæ–¹ appenders çš„ name
        error: { appenders: ['error'], level: 'error' }
    },
})

exports.logger = function (name) {  // name å– categories çš„ name
    return log4js.getLogger(name || 'default')
};
exports.use = function (app, logger) {
    app.use(log4js.connectLogger(logger || log4js.getLogger('default'), { level: 'info', format: 'è¯·æ±‚ç±»å‹/URIï¼šã€Œ :method:url ã€' })) // è¯·æ±‚ç±»å‹/URI æ ¼å¼è®¾ç½®
}
```

æ–‡ä»¶å†…å®¹ä¸éš¾ç†è§£ï¼Œæˆ‘ä»¬é¦–å…ˆé…ç½®è¦è¾“å‡ºçš„æ—¥å¿—æ–‡ä»¶è·¯å¾„ä»¥åŠåå­—ï¼Œç„¶åé…ç½®æ—¥å¿—è¾“å‡ºçš„ä¿¡æ¯æ—¶é—´æ ¼å¼ï¼Œç„¶åé…ç½®æ—¥å¿—çš„æ ¼å¼ï¼Œå¦‚ info æˆ–è€… errorï¼Œæ¥ç€é…ç½®è¯·æ±‚ç±»å‹/URI æ ¼å¼ï¼Œæœ€åæš´éœ²å‡ºå»ã€‚

æ—¥å¿—çš„è¾“å‡ºå†…å®¹å¦‚å›¾æ‰€ç¤ºï¼š

![image-20211209232718400](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211209232719.png)



ç¼–å†™ route.js æ–‡ä»¶ï¼Œç›¸ä¿¡å­¦è¿‡ express çš„ä¼™ä¼´å·²ç»éå¸¸ç†Ÿæ‚‰äº†

```js
const express = require("express");
const router = express.Router();
// å¼•å…¥æ—¥å¿—
const logger = require("./log").logger();
const errLogger = require("./log").logger("error");
// å¼•å…¥é‚®ä»¶å‘é€åŠŸèƒ½
var nodemailer = require('nodemailer');

router.post("/email", (req, res) => {
    var data = req.body;
    // è·å–å‘é€çš„æ¨¡æ¿
    const myHtml = require("./email/emailHtml").myHtml(data);
    const otherHtml = require("./email/emailHtml").otherHtml(data);
    // åˆ›å»ºè¿æ¥
    var transporter = nodemailer.createTransport({
        host: "smtp.163.com",
        port: 465, // SMTP ç«¯å£
        secureConnection: true, // ä½¿ç”¨ SSL æ–¹å¼ï¼ˆå®‰å…¨æ–¹å¼ï¼Œé˜²æ­¢è¢«çªƒå–ä¿¡æ¯ï¼‰
        auth: {
            user: 'kele_bingtang@163.com',
            // è¿™é‡Œå¯†ç ä¸æ˜¯ qq å¯†ç ï¼Œæ˜¯ä½ è®¾ç½®çš„ smtp å¯†ç 
            pass: 'GJQDWNWVGYEVTSMB'
        }
    });

    // é‚®ä»¶å‚æ•°ï¼ˆæˆ‘çš„ï¼‰
    var myOptions = {
        from: 'kele_bingtang@163.com', // å‘ä»¶åœ°å€
        to: 'kele_bingtang@163.com,2456019588@qq.com', // æ”¶ä»¶åˆ—è¡¨
        subject: data.subject, // æ ‡é¢˜
        // text å’Œ html åŒæ—¶å‘é€åªæ”¯æŒä¸€ç§
        html: myHtml,

        //  text: "æµ‹è¯•",
        /*  attachments:[{  // é™„ä»¶
       filename: '',   // é™„ä»¶å
       path: ''    // é™„ä»¶è·¯å¾„
     }] */
    };

    // é‚®ä»¶å‚æ•°ï¼ˆå‘ä»¶äººï¼‰
    var otherOptions = {
        from: 'kele_bingtang@163.com', // å‘ä»¶åœ°å€
        to: `kele_bingtang@163.com,${data.email}`, // æ”¶ä»¶åˆ—è¡¨
        subject: "Young Kbt çš„è‡´è°¢", // æ ‡é¢˜
        // text å’Œ html åŒæ—¶å‘é€åªæ”¯æŒä¸€ç§
        html: otherHtml,
    };

    // å‘é€é‚®ä»¶ï¼ˆç»™å‘ä»¶äººï¼‰
    transporter.sendMail(otherOptions, function (error, info) {
        if (error) {
            errLogger.error("å‘é€ç»™ã€Œ " + data.name + " ã€å¤±è´¥ï¼ŒåŸå› ï¼šã€Œ " + error + " ã€");
            res.status(200).send("errorï¼š" + error);
        }else{
            logger.info("å‘é€ç»™ã€Œ " + data.name + " ã€æˆåŠŸ");
        }
        console.log("å‘é€ç»™å‘ä»¶äººçš„å“åº”ä¿¡æ¯ï¼š");
        console.log(info);
    });


    // å‘é€é‚®ä»¶ï¼ˆç»™æˆ‘ï¼‰
    transporter.sendMail(myOptions, function (error, info) {
        console.log("é”™è¯¯ä¿¡æ¯ï¼š" + error);
        if (error) {
            errLogger.error("å‘é€ç»™ã€Œ Young Kbt ã€å¤±è´¥ï¼ŒåŸå› ï¼šã€Œ " + error + " ã€");
            res.status(200).send("errorï¼š" + error);
        }else{
            res.status(200).send("OK");
            logger.info("å‘ä»¶é‚®ç®±ï¼šã€Œ " + info.envelope.from + " ã€ï¼Œæ”¶ä»¶é‚®ç®±ï¼šã€Œ " + info.envelope.to + " ã€");
            logger.info("å“åº”ç»“æœï¼šã€Œ " + info.response + " ã€");
            console.log("å‘é€ç»™æˆ‘çš„å“åº”ä¿¡æ¯ï¼š");
            console.log(info);
        }
    });

    logger.info("å‘ä»¶äººï¼šã€Œ " + data.name + " ã€ï¼Œå‘ä»¶äººçš„é‚®ç®±ï¼šã€Œ " + data.email + " ã€ï¼Œå‘ä»¶ä¸»é¢˜ï¼šã€Œ " + data.subject + " ã€ï¼Œå‘ä»¶æ¶ˆæ¯ï¼šã€Œ " + data.message + " ã€");

    setTimeout(() => {
        logger.info("å‘é€ä¸€æ¬¡é‚®ä»¶çš„æ—¥å¿—åˆ†å‰²çº¿ ------------------------\n");
    }, 4000);

    setTimeout(() => {
        transporter.close();
    }, 10000);

})

module.exports = router;
```

ç¬¬ 12 å’Œ 13 è¡Œå¼•ç”¨è‡ªå®šä¹‰çš„é‚®ä»¶é¡µé¢æ¨¡æ¿ï¼Œæ¨¡æ¿å¤§å®¶æ ¹æ®è‡ªå·±çš„éœ€æ±‚è®¾è®¡é‚®ä»¶é¡µé¢ã€‚

æˆ‘çš„é‚®ä»¶é¡µé¢ä»£ç ä½äºæ ¹ç›®å½•ä¸‹çš„ `email` ç›®å½•ï¼Œåå­—å« emailHtmlï¼Œæºç ä¸ºï¼š

```js
// å‘é€ç»™æˆ‘
exports.myHtml = function(data){
    return `<div style="width: 600px;margin: 0 auto;">
            <includetail>
              <table style="text-align: center; font-size: 16px; color: #333333; border-spacing: 0px; border-collapse: collapse; width: 580px; direction: ltr">
                  <tbody>
                  <tr>
                      <td style="font-size: 14px; padding: 0px 0px 7px 0px; text-align: center;color: #0044CC">
                          ${data.name} åœ¨ Young Kbt é¦–é¡µå‘é€ç»™æ‚¨
                      </td>
                  </tr>
                  <tr style="background-color: #2279BD">
                      <td style="padding: 0px">
                          <table style="border-spacing: 0px; border-collapse: collapse; width: 100%">
                              <tbody>
                              <tr>
                                  <td style="padding: 0px; text-align: center;">
                                      <img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/user/20211205131212.jpg" alt="è¯·åœ¨ä¸Šæ–¹é€‰æ‹©ä¿¡ä»»ï¼Œä»¥æ­¤æ˜¾ç¤ºå¤´åƒ">
                                  </td>
                              </tr>
                              <tr>
                                  <td style="font-size: 38px; color: #FFFFFF; padding: 12px 22px 4px 22px; text-align: center;" colspan="3">
                                      Young Kbt
                                  </td>
                              </tr>
                              <tr>
                                  <td style="font-size: 20px; color: #FFFFFF; padding: 0px 22px 18px 22px; text-align: center;" colspan="3">
                                    äººé—²è½¦é©¬æ…¢ï¼Œè·¯é¥æ˜Ÿäº¦è¾
                                  </td>
                              </tr>
                              </tbody>
                          </table>
                      </td>
                  </tr>
                  <tr>
                      <td style="background-color: #5BA9DF; border-bottom-style: solid; border-bottom-color: #2279BD; border-bottom-width: 4px;">
                          <table style="color: #333333; border-spacing: 0px; border-collapse: collapse; width: 100%; color: #fff">
                              <tbody>
                                <tr>
                                  <td style="font-size: 18px; padding: 0px 0px 5px 0px;">
                                    <p style="text-align: center">
                                      <span style="font-weight:bold;">${data.name} </span>
                                      <span>å‘é€çš„ä¸»é¢˜ï¼š</span></p>
                                      <p style="font-size: 16px; letter-spacing: 0.5px; text-indent: 16px; padding:0 20px; line-height: 30px; text-align: left;">
                                      ${data.subject}
                                    </p>
                                  </td>
                                </tr>
                                <tr>
                                  <td style="font-size: 18px; padding: 0px 0px 5px 0px;">
                                    <p style="text-align: center; margin-top: 0;">
                                      <span style="font-weight:bold;">${data.name} </span>
                                      <span>å‘é€çš„å†…å®¹ï¼š</span>
                                    </p>
                                      <p style="font-size: 16px;letter-spacing: 0.5px; text-indent: 16px; padding:0 20px; line-height: 30px; text-align: left;">
                                      ${data.message}
                                    </p>
                                  </td>
                                </tr>	
                                <tr>
                                    <td style="font-size: 16px; padding: 30px 20px; text-align: center">
                                      å¦‚æœæ‚¨å¸Œæœ›å›å¤ä»–/å¥¹ï¼Œè¯·å‘é€åˆ°ä»–/å¥¹çš„é‚®ç®±ï¼š
                                      <p style="color: #0044CC; font-weight: bold">${data.email}</p>
                                    </td>
                                </tr>
                              </tbody>
                          </table>
                      </td>
                  </tr>
                  <tr>
                      <td style="padding: 35px 0px; color: #B2B2B2; font-size: 12px">
                          From Young Kbt
                          <br>
                          This is a WebSite
                          <br>
                          ${new Date().getFullYear()}-${new Date().getMonth() + 1 == 13 ? 12 : new Date().getMonth() + 1}-${new Date().getDate() > 10 ? new Date().getDate() : '0' + new Date().getDate()}
                            ${new Date().getHours() > 10 ? new Date().getHours() : '0' + new Date().getHours()}:${new Date().getMinutes() > 10 ? new Date().getMinutes() : '0' + new Date().getMinutes()}:${new Date().getSeconds() > 10 ? new Date().getSeconds() : '0' + new Date().getSeconds()}
                      </td>
                  </tr>
                  <tr>
                      <td style="padding: 0px 0px 10px 0px; color: #B2B2B2; font-size: 12px">
                          Copyright Young Kbt WebSite             
                      </td>
                  </tr>
                  </tbody>
              </table>
            </includetail>
          </div`;
}

// å‘é€ç»™å‘ä»¶äºº
exports.otherHtml = function(data){
    return `<div style="width: 600px;margin: 0 auto;">
            <includetail>
              <table
                style="text-align: center; font-size: 16px; color: #333333; border-spacing: 0px; border-collapse: collapse; width: 580px; direction: ltr">
                <tbody>
                  <tr>
                    <td style="font-size: 14px; padding: 0px 0px 7px 0px; text-align: center;color: #0044CC">
                      å°Šæ•¬çš„ <span style="font-weight: bold;">${data.name}</span>ï¼ŒYoung Kbt æ„Ÿè°¢æ‚¨çš„é‚®ä»¶
                    </td>
                  </tr>
                  <tr style="background-color: #2279BD">
                    <td style="padding: 0px">
                      <table style="border-spacing: 0px; border-collapse: collapse; width: 100%">
                        <tbody>
                          <tr>
                            <td style="padding: 0px; text-align: center;">
                              <img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/user/20211205131212.jpg" alt="è¯·åœ¨ä¸Šæ–¹é€‰æ‹©ä¿¡ä»»ï¼Œä»¥æ­¤æ˜¾ç¤ºå¤´åƒ">
                            </td>
                          </tr>
                          <tr>
                            <td style="font-size: 38px; color: #FFFFFF; padding: 12px 22px 4px 22px; text-align: center;"
                              colspan="3">
                              Young Kbt
                            </td>
                          </tr>
                          <tr>
                            <td style="font-size: 20px; color: #FFFFFF; padding: 0px 22px 18px 22px; text-align: center;"
                              colspan="3">
                              äººé—²è½¦é©¬æ…¢ï¼Œè·¯é¥æ˜Ÿäº¦è¾
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                  <tr>
                    <td
                      style="background-color: #5BA9DF; border-bottom-style: solid; border-bottom-color: #2279BD; border-bottom-width: 4px;">
                      <table style="color: #333333; border-spacing: 0px; border-collapse: collapse; width: 100%; color: #fff">
                        <tbody>
                          <tr>
                            <td style="font-size: 18px; padding: 0px 0px 5px 0px;">
                              <p style="text-align: center">
                                <span style="font-weight:bold">Young Kbt</span>
                                <span>æç¤ºæ‚¨ï¼š</span>
                              </p>
                              <p
                                style="font-size: 16px; letter-spacing: 0.5px; text-indent: 32px; padding:0 20px; line-height: 30px; text-align: left;">
                                æœ¬é‚®ä»¶ç”± Young Kbt's index ç½‘ç«™å‘é€ç»™æ‚¨ï¼Œ
                                <span style="color: #1546a8; font-weight: bold;">å¦‚æœéæœ¬äººæ“ä½œï¼Œè¯·å¿½ç•¥å³å¯ã€‚</span>
                              </p>
                            </td>
                          </tr>
                          <tr>
                            <td style="font-size: 18px; padding: 0px 0px 5px 0px;">
                              <p style="text-align: center; margin-top: 0;">
                                <span style="font-weight:bold">Young Kbt</span>
                                <span>å›å¤æ‚¨ï¼š</span>
                              </p>
                              <p
                                style="font-size: 16px;letter-spacing: 0.5px; text-indent: 32px; padding:0 20px; line-height: 30px; text-align: left;">
                                æ„Ÿè°¢æ‚¨æä¾›çš„å®è´µæ¶ˆæ¯ï¼Œæˆ‘ä¼šæ ¹æ®æ‚¨çš„å†…å®¹å°½å¿«å›å¤æ‚¨ï¼Œå¦‚æœæ—¶é—´è¾ƒå»¶è¿Ÿï¼Œè¯·æ‚¨è§è°…ã€‚
                              </p>
                            </td>
                          </tr>
                          <tr>
                            <td style="font-size: 16px; padding: 30px 20px; text-align: center">
                              å¦‚æœæ‚¨å¯¹æˆ‘çš„ç½‘ç«™æ„Ÿå…´è¶£ï¼Œè¯·è®¿é—®ï¼š
                              <p style="color: #0044CC; font-weight: bold">
                               <a href="youngkbt.cn" style="color: #0044CC; text-decoration: none">youngkbt.cn</a>
                              </p>
                              <p style="color: #0c3388;font-size: 14px; margin: 15px 0 0 0;">æœ¬ç½‘ç«™ä»…æ˜¯ä¸ªäººä½¿ç”¨ï¼Œå¹¶ä¸å¸¦æœ‰å•†ä¸šç”¨é€”</p>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                  <tr>
                    <td style="padding: 35px 0px; color: #B2B2B2; font-size: 12px">
                      From Young Kbt
                      <br>
                      This is a WebSite
                      <br>
                      ${new Date().getFullYear()}-${new Date().getMonth() + 1 == 13 ? 12 : new Date().getMonth() + 1}-${new
    Date().getDate() > 10 ? new Date().getDate() : '0' + new Date().getDate()}
                      ${new Date().getHours() > 10 ? new Date().getHours() : '0' + new Date().getHours()}:${new
    Date().getMinutes() > 10 ? new Date().getMinutes() : '0' + new Date().getMinutes()}:${new
    Date().getSeconds() > 10 ? new Date().getSeconds() : '0' + new Date().getSeconds()}
                    </td>
                  </tr>
                  <tr>
                    <td style="padding: 0px 0px 10px 0px; color: #B2B2B2; font-size: 12px">
                      Copyright Young Kbt WebSite
                    </td>
                  </tr>
                </tbody>
              </table>
            </includetail>
          </div>`
};
```

ç¼–å†™ express çš„å…¥å£æ–‡ä»¶ app.jsï¼Œç›‘å¬ 5678 ç«¯å£

```js
const express = require("express");
const router = require("./router");
const log = require("./log");
const app = express();

log.use(app);
app.use(express.urlencoded({ extended: false }));
app.use(express.json());

app.use( ( request , response , next ) => {
    response.header( 'Access-Control-Allow-Origin' , '*') // è·¨åŸŸæœ€é‡è¦çš„ä¸€æ­¥ è®¾ç½®å“åº”å¤´
    next(); // æ‰§è¡Œ next å‡½æ•°æ‰§è¡Œåç»­ä»£ç 
})

app.use('/',router);

app.listen('5678',() => {
    console.log("5678 ç«¯å£çš„æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ");
})
```

å†™å®Œé‚®ç®±çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œæµ‹è¯•ï¼Œè¿›å…¥é‚®ç®±é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œä½¿ç”¨ `node app.js` å¯åŠ¨ node é¡¹ç›®ã€‚

```sh
node app.js
```

å› ä¸ºæ˜¯ POST è¯·æ±‚ï¼Œæ‰€ä»¥ä½¿ç”¨ Postman ç­‰å·¥å…·è¿›è¡Œæµ‹è¯•ï¼Œè®¿é—® `localhost:5678/email`ï¼Œå¡«å†™ JSON æ ¼å¼ï¼ŒåŒ…å« nameã€emailã€subjectã€message å››ä¸ªå‚æ•°çš„æ•°æ®å³å¯ã€‚

![image-20211210005339569](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211210005340.png)

### å®˜æ–¹é•œåƒéƒ¨ç½²

åœ¨æœ¬åœ°ç¼–å†™æµ‹è¯•å®Œé‚®ç®±çš„åŠŸèƒ½åï¼Œæˆ‘ä»¬å°†å…¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæˆ‘ä¸Šä¼ çš„ç›®å½•æ˜¯ `docker/node/email` ä¸‹ï¼Œç„¶åéœ€è¦æœåŠ¡å™¨å®‰è£… node ç¯å¢ƒï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ dockerï¼Œæ‰€ä»¥ç›´æ¥æ‹‰å– nodeã€‚

```sh
docker pull node
```

ä¸‹è½½å®Œ node é•œåƒåï¼Œä¸è¦é©¬ä¸Šå¯åŠ¨å®ƒï¼Œå› ä¸º node é¡¹ç›®éœ€è¦æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼Œç”Ÿæˆ node_modules ç›®å½•ï¼Œæ‰€ä»¥ä½¿ç”¨ Dockerfile æ–‡ä»¶æ¥æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ã€‚

åœ¨ `docker/node/email` ç›®å½•ä¸‹ï¼Œåˆ›å»ºå¹¶ç¼–å†™ Dockerfile æ–‡ä»¶

```sh
cd docker/node/email
vim Dockerfile
```

æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```dockerfile
FROM node					# åŸºäº node é•œåƒåˆ›å»ºæ–°çš„é•œåƒ
WORKDIR /home/email			# åˆ›å»ºé»˜è®¤å·¥ä½œç›®å½•
COPY . /home/email			# å°†å½“å‰ç›®å½•çš„æ‰€æœ‰å†…å®¹æ‹·è´åˆ°å®¹å™¨ä¸­
RUN npm i					# æ‰§è¡Œæ‰“åŒ…å‘½ä»¤
EXPOSE 5678					# æš´éœ² 5678 ç«¯å£
ENTRYPOINT node ./app.js 	# å¯åŠ¨å®¹å™¨æ—¶ï¼Œå¯åŠ¨ app.js æ–‡ä»¶
```

ä¸éš¾çœ‹å‡ºï¼Œåœ¨ç”Ÿæˆ docker é•œåƒçš„åŒæ—¶ï¼Œå®ƒä¼šå°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹æ‹·è´åˆ°å®¹å™¨ä¸­ï¼Œè¿™äº›å†…å®¹å°±æ˜¯æˆ‘ä»¬å†™çš„é‚®ç®±é¡¹ç›®ã€‚æ¥ç€å®ƒä¼šæ‰§è¡Œæ‰“åŒ…å‘½ä»¤ `npm i`ï¼Œi ä»£è¡¨ installã€‚ç„¶åæš´éœ² 5678 ç«¯å£ï¼Œæœ€ååœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œå¯åŠ¨ app.js æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œé¡¹ç›®ã€‚

å†™å¥½ Dockerfile æ–‡ä»¶ï¼Œæˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œæ„å»ºåŸºäº node ç¯å¢ƒè€Œæ­å»ºçš„ã€Œé‚®ç®±å‘é€ã€é•œåƒ

```sh
docker build -t email:1.0 .
```

å¯åŠ¨è¿™ä¸ªåå« emailã€ç‰ˆæœ¬ä¸º 1.0 çš„å®¹å™¨ï¼Œå½“å¯åŠ¨è¿™ä¸ªå®¹å™¨çš„æ—¶å€™ï¼Œå†…éƒ¨å°±ä¼šæ‰§è¡Œ `node ./app.js` å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯ Dockerfile æ–‡ä»¶çš„ ENTRYPOINT æŒ‡ä»¤ï¼Œéƒ¨ç½²é¡¹ç›®ã€‚

```sh
docker run -d --name email \
-v /docker/node/email/router.js:/home/email/router.js \
-v /docker/node/email/app.js:/home/email/app.js \
-v /docker/node/email/log.js:/home/email/log.js \
-v /docker/node/email/logs:/home/email/logs \
-v /docker/node/email/email:/home/email/email \
--network web --network-alias email \
email:1.0
```

ä¸è¦æƒŠè®¶ä¼šæœ‰é‚£ä¹ˆå¤šå¯åŠ¨å‘½ä»¤ï¼Œè¿™é‡Œä¸»è¦å®ç°æŒ‚è½½åŠŸèƒ½ï¼Œåªè¦å®¿ä¸»æœºçš„æ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼Œåˆ™å®¹å™¨å†…çš„æ–‡ä»¶ä¹Ÿä¼šåŒæ­¥æ”¹å˜ï¼Œæ¯•ç«Ÿè°ä¹Ÿæ— æ³•ç¡®å®šè‡ªå·±å†™çš„æ–‡ä»¶ä»¥åéƒ½ä¸ä¼šä¿®æ”¹ï¼Œå¯¹å§ã€‚

è‡³äºç¬¬ 7 è¡Œçš„ `network` ç½‘ç»œï¼Œå› ä¸º Nginx æ‰€å¤„çš„ç½‘ç»œæ˜¯ web ç½‘ç»œï¼Œè€Œæƒ³è®© Nginx è®¿é—® node é¡¹ç›®ï¼Œåˆ™éœ€è¦è®©ä¸¤è€…å¤„äºåŒä¸€ä¸ªç½‘ç»œä¸Šã€‚ `network-alias` æ˜¯ç½‘ç»œåˆ«åï¼ŒNginx ä¼šæ ¹æ®è¿™ä¸ªç½‘ç»œåˆ«åæ‰¾åˆ°å¤„äºç›¸åŒç½‘ç»œä¸‹çš„ node é¡¹ç›®ï¼Œå°½é‡ä¸å®¹å™¨åä¿æŒä¸€è‡´ã€‚

æ­¤æ—¶é‚®ç®±é¡¹ç›®å·²ç»éƒ¨ç½²æˆåŠŸäº†ï¼Œä½†æ˜¯ Nginx è¿˜æ— æ³•è®¿é—®è¿™ä¸ªé‚®ç®±é¡¹ç›®ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰é…ç½® location æ¨¡å—æ¥è®¿é—®é‚®ç®±é¡¹ç›®ã€‚

```nginx
server {
    listen       5678;
    server_name  localhost;

    location /email {
	    proxy_pass http://email:5678;    # email å°±æ˜¯ç½‘æ¡¥åˆ«åï¼ŒNginx é€šè¿‡å®ƒæ‰¾åˆ° email å®¹å™¨
    }
}
```

å®é™…ä¸Šæˆ‘å¹¶æ²¡æœ‰ç›´æ¥å°†ä¸Šé¢çš„ server æ¨¡å—æ”¾åœ¨é…ç½®æ–‡ä»¶é‡Œï¼Œè€Œæ˜¯å°†ä¸Šé¢çš„å†…å®¹æ”¾åœ¨æ–°åˆ›å»ºçš„ email_5678.conf æ–‡ä»¶é‡Œï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶è¿›è¡Œè½¬å‘ã€‚

![image-20211210005924513](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211210005925.png)

å› ä¸ºæ ¸å¿ƒé…ç½®æ–‡ä»¶ä½¿ç”¨äº† include æŒ‡ä»¤å°† conf ç›®å½•ä¸‹çš„æ‰€æœ‰ .conf æ–‡ä»¶å¼•å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åˆ›å»ºæ–°çš„é…ç½®æ–‡ä»¶ email_5678.conf å³å¯ã€‚

ç„¶åæ–°çš„é…ç½®æ–‡ä»¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```nginx
server {
    listen 431;		# 431 æ˜¯ https çš„é»˜è®¤ç«¯å£ï¼Œ80 æ˜¯ http çš„é»˜è®¤ç«¯å£
    server_name www.youngkbt.cn;
    # ...... å…¶ä»– location

    # è½¬å‘ç»™å…¶ä»–çš„ conf æ–‡ä»¶
    location /email {
        proxy_pass http://localhost:5678;
    }

    # ...... å…¶ä»– location
}
```

å½“è®¿é—® `/email` çš„æ—¶å€™ï¼Œè§¦å‘ 431 ç«¯å£çš„çš„ `/email`ï¼Œç„¶åå†…éƒ¨å°±ä¼šæ‰§è¡Œ `proxy_pass` æŒ‡ä»¤ï¼Œå°†è¯·æ±‚è½¬å‘ç»™æœ¬åœ°çš„ 5678 ç«¯å£ï¼Œæ­¤æ—¶ email_5678.conf æ–‡ä»¶æ­£å¥½ç›‘å¬è¿™ä¸ª 5678 ç«¯å£ï¼Œæ‰€ä»¥å°±ä¼šå°† `/email` è¯·æ±‚å‘ç»™è‡ªå·±çš„ location ï¼Œæ‰§è¡Œæ–°çš„ `proxy_pass` æŒ‡ä»¤ï¼Œè€Œè¿™ä¸ªæŒ‡ä»¤æ‰æ˜¯å°†è¯·æ±‚å‘ç»™ node é‚®ç®±é¡¹ç›®ï¼Œè§¦å‘é‚®ç®±çš„å‘é€ã€‚

è®°å¾—é‡å¯ Ngixnï¼Œä½¿å¾—é…ç½®æ–‡ä»¶ç”Ÿæ•ˆã€‚

**ä»€ä¹ˆæ—¶å€™å¤–ç•Œä¼šè®¿é—® `/email`ï¼Ÿ**

è‡ªå·±å†™ä¸€ä¸ª &lt;a> æ ‡ç­¾ï¼Œå¡«å†™ä½ çš„æœåŠ¡å™¨çš„åœ°å€åŠ ä¸Š `/email` å³å¯ã€‚

æˆ‘è‡ªå·±å†™çš„ä¸æ˜¯ &lt;a> æ ‡ç­¾ï¼Œè€Œæ˜¯ä¸€ä¸ª js æ–‡ä»¶ï¼Œç‚¹å‡»æŒ‰é’®è§¦å‘ ajax è¯·æ±‚ï¼Œå…·ä½“æºç è¯·çœ‹ [é¦–é¡µéƒ¨ç½²](#é¦–é¡µéƒ¨ç½²) çš„ **JS æ–‡ä»¶**ã€‚



### è‡ªå®šä¹‰é•œåƒéƒ¨ç½²

æˆ‘åœ¨ä½¿ç”¨äº†åŸºäºå®˜æ–¹é•œåƒçš„éƒ¨ç½²å‡ å¤©åï¼Œå‘ç°è¿™ä¸ªé•œåƒå¤ªå¤§äº†ï¼Œæœ‰ 999MBï¼Œå¦‚å›¾ï¼š

![img](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211217011316.png)

äºæ˜¯æˆ‘æ‰“ç®—åŸºäº Centos7.9 æ„å»ºä¸€ä¸ª node ç¯å¢ƒçš„é•œåƒï¼Œè¿™é‡Œæä¾› Dockerfile æ–‡ä»¶å†…å®¹ï¼š

```dockerfile
# è¿™æ˜¯æ—©æœŸçš„ç‰ˆæœ¬ï¼Œç›´æ¥å¼•å…¥ node é•œåƒï¼Œä½†æ˜¯è¯¥é•œåƒå¤ªå¤§äº†ï¼Œæ„å»ºå 999MBï¼Œæ‰€ä»¥æˆ‘å°±è‡ªå·±åˆ›å»ºä¸€ä¸ª nodejs é•œåƒ
# FROM node  
FROM centos:7.9

# nodejs ç‰ˆæœ¬
ARG NODE_VERSION="v16.13.1"

WORKDIR /opt/sendEmail
# å°†å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶æ”¾å…¥å®¹å™¨çš„ /opt/sendEmail
COPY . /opt/sendEmail

# å› ä¸º COPY ä¹Ÿä¼šå°†å½“å‰çš„ nodejs å‹ç¼©åŒ…æ·»åŠ è¿›å…¥ï¼Œæ‰€ä»¥å¯ä»¥åˆ é™¤æ‰
RUN rm -f /opt/sendEmail/node-${NODE_VERSION}-linux-x64.tar.xz

# ------ äºŒé€‰ä¸€ï¼Œå¯æ³¨é‡Š ------
# å¦‚æœäº‹å…ˆä¸‹è½½çš„ node å‹ç¼©åŒ…ï¼Œåˆ™æ”¾å…¥ Dockerfile æ‰€åœ¨çš„ç›®å½•ä¸‹ï¼Œåˆ©ç”¨ ADD ä¼ å…¥å¹¶è‡ªåŠ¨è§£å‹
ADD node-${NODE_VERSION}-linux-x64.tar.xz /usr/local/
# ADD æŒ‡ä»¤è‡ªåŠ¨è§£å‹ï¼Œæ‰€ä»¥å¯ä»¥åˆ é™¤ä¼ å…¥çš„å‹ç¼©åŒ…
RUN rm -f /usr/local/node-${NODE_VERSION}-linux-x64.tar.xz
# ------ ------ ------ ------ ------ ------ ------ ------ ------ ------

# ------ äºŒé€‰ä¸€ï¼Œå¯æ³¨é‡Š ------
# å¦‚æœæƒ³è¦è¿œç¨‹ä¸‹è½½ node å‹ç¼©åŒ…ï¼Œåˆ™å–æ¶ˆä¸‹é¢çš„ RUN æŒ‡ä»¤æ³¨é‡Š
#RUN yum install -y wget tar \
#     && cd /usr/local/ \
#     && wget https://nodejs.org/dist/${NODE_VERSION}/node-${NODE_VERSION}-linux-x64.tar.xz \
#     && tar xvf node-${NODE_VERSION}-linux-x64.tar.xz \
#     && rm -f node-${NODE_VERSION}-linux-x64.tar.xz
# ------ ------ ------ ------ ------ ------ ------ ------ ------ ------

# å°†è§£å‹çš„ node ç›®å½•é‡å‘½å
RUN cd /usr/local/ \
     && mv node-${NODE_VERSION}-linux-x64 node

# å°† node å‘½ä»¤æ·»åŠ è‡³å…¨å±€å˜é‡ï¼ŒåŒ…æ‹¬äº† node å’Œ npm
ENV PATH=$PATH:/usr/local/node/bin

# å®‰è£…ä¾èµ–åŒ…
RUN cd /opt/sendEmail \
     && npm install

# æš´éœ² 7272 ç«¯å£
EXPOSE 7272
# å¯åŠ¨å®¹å™¨åï¼Œè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å¯åŠ¨é¡¹ç›®
ENTRYPOINT node ./app.js
```

æˆ‘éƒ½æœ‰æ³¨é‡Šè¯´æ˜ï¼Œè¿™é‡Œå¤§æ¦‚æ€»ç»“ä¸‹ï¼š

åŸºäº Centos7.9 ç³»ç»Ÿæ­å»º node é•œåƒï¼Œé¦–å…ˆä¸‹è½½ nodejsï¼Œä¼ åˆ°ä¸ Dockerfile åŒç›®å½•ä¸‹ï¼Œç„¶åæ‰§è¡Œ Dockerfile çš„æ—¶å€™ï¼Œå°† nodejs ä¼ å…¥é•œåƒé‡Œï¼Œè‡ªåŠ¨è§£å‹ï¼Œå¹¶å°† `node` å’Œ `npm` å‘½ä»¤æ·»åŠ è‡³å…¨å±€å˜é‡ï¼Œç„¶åæŠŠé‚®ç®±é¡¹ç›®çš„ä»£ç ä¼ å…¥é•œåƒï¼Œæ¥ç€åˆ©ç”¨å…¨å±€å˜é‡ `npm` è¿›è¡Œå®‰è£… `nodes_modules`ï¼Œæœ€åå†™ `ENTRYPOINT` æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä¼šåœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™è‡ªåŠ¨å¯åŠ¨é¡¹ç›®ï¼Œè¿™æ ·å°±ä¸éœ€è¦æˆ‘ä»¬äº²è‡ªè¿›å…¥å®¹å™¨é‡Œå¯åŠ¨é¡¹ç›®ã€‚

å¦‚æœä¸å–œæ¬¢å…ˆä¸‹è½½ nodejsï¼Œä¼ å…¥æœåŠ¡å™¨é‡Œï¼Œé‚£ä¹ˆå°±åœ¨æ„å»ºå®¹å™¨æ—¶ä½¿ç”¨ `wget` ä¸‹è½½å³å¯ï¼Œä¸Šé¢å†…å®¹çš„æ³¨é‡Šå°±æ˜¯ `wget` ç›¸å…³æ“ä½œï¼ŒäºŒé€‰ä¸€ã€‚

æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ‰§è¡Œ Dockerfileï¼Œæ„å»ºé•œåƒï¼š

```sh
docker build -t email:2.0 .
```

å¯ä»¥çœ‹åˆ°æ„å»ºçš„æ–°é•œåƒå¤§å°å·²ç»ç¼©å°ä¸€åŠå·¦å³ï¼Œå¹¶ä¸”åŠŸèƒ½æ²¡æœ‰ä»»ä½•ç¼ºå¤±ï¼Œå¦‚å›¾ï¼š

![img](https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/%E5%85%B3%E4%BA%8E/%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99/20211217012127.png)

2.0 ç‰ˆæœ¬çš„é‚®ç®±é•œåƒæ„å»ºæºç æˆ‘å·²ç»æ”¾åˆ°ä¸‹è½½ç«™ç‚¹é‡Œäº†ï¼Œå¦‚æœéœ€è¦ï¼Œæˆ‘åœ¨ä¸Šæ–¹æä¾›äº†ä¸‹è½½åœ°å€ï¼Œç‚¹å‡» [åºè¨€](#åºè¨€) ç›´è¾¾ã€‚

## æ¶ˆæ¯æç¤ºæ•ˆæœä»£ç 

åœ¨å‘é€é‚®ç®±çš„è¿‡ç¨‹ï¼Œå¦‚æœæ²¡æœ‰å¡«å†™ä¸€äº›å¿…è¦çš„ä¿¡æ¯ï¼Œåˆ™ä¼šè¢«æç¤ºï¼Œé¦–é¡µçš„æç¤ºæ˜¯ä»¿ç…§ Element UIï¼Œåªæœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼š

```js
/**
 * æ·»åŠ æ¶ˆæ¯æç¤º
 * contentï¼šå†…å®¹
 * typeï¼šå¼¹çª—ç±»å‹ï¼ˆtipã€successã€warningã€dangerï¼‰
 * startHeightï¼šç¬¬ä¸€ä¸ªå¼¹çª—çš„é«˜åº¦ï¼Œé»˜è®¤ 50
 * dieTimeï¼šå¼¹çª—æ¶ˆå¤±æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 3000 æ¯«ç§’
 */
function addTip(content, type, startHeight = 50, dieTime = 3000) {
  var tip = document.querySelectorAll(".tip");
  var time = new Date().getTime();
  // è·å–æœ€åæ¶ˆæ¯æç¤ºå…ƒç´ çš„é«˜åº¦
  var top = tip.length == 0 ? 0 : tip[tip.length - 1].getAttribute("data-top");
  // å¦‚æœäº§ç”Ÿä¸¤ä¸ªä»¥ä¸Šçš„æ¶ˆæ¯æç¤ºï¼Œåˆ™å‡ºç°åœ¨ä¸Šä¸€ä¸ªæç¤ºçš„ä¸‹é¢ï¼Œå³é«˜åº¦æ·»åŠ ï¼Œå¦åˆ™é»˜è®¤ 50
  var lastTop =
    parseInt(top) +
    (tip.length != 0 ? tip[tip.length - 1].offsetHeight + 17 : startHeight);

  let div = document.createElement("div");
  div.className = `tip tip-${type} ${time}`;
  div.style.top = parseInt(top) + "px";
  div.setAttribute("data-top", lastTop);
  if (type == "info" || type == 1) {
    div.innerHTML = `<i class="iconfont icon-info icon"></i><p class="tip-info-content">${content}</p>`;
  } else if (type == "success" || type == 2) {
    div.innerHTML = `<i class="iconfont icon-dagouyouquan icon"></i><p class="tip-success-content">${content}</p>`;
  } else if (type == "danger" || type == 3) {
    div.innerHTML = `<i class="iconfont icon-cuowu icon"></i><p class="tip-danger-content">${content}</p>`;
  } else if (type == "warning" || type == 4) {
    div.innerHTML = `<i class="iconfont icon-gantanhao icon"></i><p class="tip-warning-content">${content}</p>`;
  }
  document.body.appendChild(div);

  let timeTip = document.getElementsByClassName(time)[0];
  setTimeout(() => {
    timeTip.style.top = parseInt(lastTop) + "px";
    timeTip.style.opacity = "1";
  }, 10);

  // æ¶ˆæ¯æç¤º dieTime ç§’åéšè—å¹¶è¢«åˆ é™¤
  setTimeout(() => {
    timeTip.style.top = "0px";
    timeTip.style.opacity = "0";

    // ä¸‹é¢çš„æ‰€æœ‰å…ƒç´ å›åˆ°å„è‡ªæ›¾ç»çš„å‡ºå‘ç‚¹
    var allTipElement = nextAllTipElement(timeTip);
    for (let i = 0; i < allTipElement.length; i++) {
      var next = allTipElement[i];
      var top =
        parseInt(next.getAttribute("data-top")) - next.offsetHeight - 17;
      next.setAttribute("data-top", top);
      next.style.top = top + "px";
    }
    setTimeout(() => {
      timeTip.remove();
    }, 500);
  }, dieTime);
}
/**
 * è·å–åé¢çš„å…„å¼Ÿå…ƒç´ 
 */
function nextAllTipElement(elem) {
  var r = [];
  var n = elem;
  for (; n; n = n.nextSibling) {
    if (n.nodeType === 1 && n !== elem) {
      r.push(n);
    }
  }
  return r;
}
```

CSS æ ·å¼ï¼š

```css
/* æç¤ºæ¡†å…ƒç´  */
.tip {
  position: fixed;
  display: flex;
  top: -10px;
  left: 50%;
  opacity: 0;
  min-width: 320px;
  transform: translateX(-50%);
  transition: opacity 0.3s linear, top 0.4s, transform 0.4s;
  z-index: 99999;
  padding: 15px 15px 15px 20px;
  border: 1px solid #ebeef5;
  border-radius: 4px;
  grid-row: 1;
  line-height: 17px;
}

.tip p {
  line-height: 17px;
  margin: 0;
  font-size: 14px;
}

.icon {
  margin-right: 10px;
  line-height: 17px;
}

.tip-success {
  color: #67c23a;
  background-color: #f0f9eb;
  border-color: #e1f3d8;
}

.tip-success .tip-success-content {
  color: #67c23a;
}

.tip-danger {
  color: #f56c6c;
  background-color: #fef0f0;
  border-color: #fde2e2;
}

.tip-danger .tip-danger-content {
  color: #f56c6c;
}

.tip-info {
  background-color: #edf2fc;
  border-color: #ebeef5;
}

.tip-info .tip-info-content {
  color: #909399;
}

.tip-warning {
  color: #e6a23c;
  background-color: #fdf6ec;
  border-color: #faecd8;
}

.tip-warning .tip-warning-content {
  margin: 0;
  color: #e6a23c;
  line-height: 21px;
  font-size: 14px;
}
```

å›¾ç‰‡æ˜¯é˜¿é‡Œäº‘çš„å›¾æ ‡åº“ï¼Œåœ¨çº¿åœ°å€ï¼š

```html
<link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
```

ä½¿ç”¨åªéœ€è¦è°ƒç”¨ `addTip` å³å¯ï¼š

```js
function test() {
    var hours = new Date().getHours();
    var minutes = new Date().getMinutes();
    var seconds = new Date().getSeconds();
    hours = hours < 10 ? "0" + hours : hours;
    minutes = minutes < 10 ? "0" + minutes : minutes;
    seconds = seconds < 10 ? "0" + seconds : seconds;
    if (hours >= 6 && hours < 11) {
        addTip(
            `æ—©ä¸Šå¥½å‘€~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œåƒæ—©é¤äº†å—ï¼ŸğŸ˜ŠğŸ¤­`,
            "info",
            50,
            4000
        );
    } else if (hours >= 12 && hours <= 16) {
        addTip(
            `ä¸‹åˆå¥½å‘€~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œç¹å¿™çš„ä¸‹åˆä¹Ÿè¦é€‚å½“ä¼‘æ¯å“¦ğŸ¥¤ğŸ€~~`,
            "info",
            50,
            4000
        );
    } else if (hours >= 16 && hours <= 19) {
        addTip(
            `åˆ°é»„æ˜äº†~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œè¯¥å‡†å¤‡åƒé¥­å•¦ğŸ¥—ğŸ–~~`,
            "info",
            50,
            4000
        );
    } else if (hours >= 19 && hours < 24) {
        addTip(
            `æ™šä¸Šå¥½å‘€~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œè¯¥å‡†å¤‡æ´—æ¼±ç¡è§‰å•¦ğŸ¥±ğŸ˜ª~~`,
            "info",
            50,
            4000
        );
    } else if (hours >= 0 && hours < 6) {
        addTip(
            `åˆ«å†ç†¬å¤œäº†~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œæ—©ç‚¹ç¡å§ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¬£èµæ—©ä¸Šçš„å¤ªé˜³~~ğŸ˜‡ğŸ›`,
            "info",
            50,
            4000
        );
    }
}
```

